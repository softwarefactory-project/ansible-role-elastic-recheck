<IfModule mod_proxy.c>
    # Elasticsearch doew not accept http requests
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
    SSLProxyCheckPeerExpire off

{% for user in users %}
{% if 'autologin' in user and user['autologin'] | lower == 'basic' %}
    Include /etc/httpd/conf.d/kibana_autologin_{{ user['tenant'] | replace('.', '_') }}.conf
{% endif %}
{% endfor %}

    <Location "/">
        RedirectMatch ^/$ http://{{ fqdn }}/analytics/
    </Location>

    <Location "/analytics">
        ProxyPass http://{{ fqdn }}:5601
        ProxyPassReverse http://{{ fqdn }}:5601
    </Location>

    <Location /elasticsearch>
        ProxyPass https://{{ fqdn }}:9200
        ProxyPassReverse https://{{ fqdn }}:9200
    </Location>
</IfModule>
