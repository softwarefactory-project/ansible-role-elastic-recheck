---
### DEFAULT FILE

_meta:
  type: "rolesmapping"
  config_version: 2

# Define your roles mapping here

## Demo roles mapping

all_access:
  reserved: false
  backend_roles:
  - "admin"
  description: "Maps admin to all_access"

own_index:
  reserved: false
  users:
  - "*"
  description: "Allow full access to an index named like the username"

logstash:
  reserved: false
  backend_roles:
  - "logstash"

kibana_user:
  reserved: false
  backend_roles:
  - "kibanauser"
  description: "Maps kibanauser to kibana_user"

readall:
  reserved: false
  backend_roles:
  - "readall"

manage_snapshots:
  reserved: false
  backend_roles:
  - "snapshotrestore"

kibana_server:
  reserved: true
  users:
  - "kibanaserver"

kibana_read_only:
  reserved: false
  backend_roles:
  - "kibana_read_only"
  description: "Maps kibana_read_only to kibana_read_only"

kibana_viewer:
  reserved: false
  backend_roles:
  - "kibana_viewer"
  description: "Maps kibana viewer role"

# NOTE: internal_users does not provide kibana read only user, so
# we can skip it.
# NOTE: all roles without kibana (read only user), logstash and
# kibanaserver got admin privileges.
{% for user in users %}
{% if 'role' in user and 'tenant' in user %}
{% if user.role == 'readonly' %}
kibana_viewer_{{ user.tenant | replace('.', '_') }}:
  reserved: false
  backend_roles:
  - "kibana_viewer_{{ user.tenant | replace('.', '_') }}"
  description: "Maps kibana viewer role for tenant {{ user.tenant | replace('.', '_') }}"
{% endif %}
{% endif %}
{% endfor %}
